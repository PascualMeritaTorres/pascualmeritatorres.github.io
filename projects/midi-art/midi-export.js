class MidiExport{constructor(){this.ticksPerBeat=128}"export"(e,t="text2midiart",r=120){if(!e||0===e.length)return void console.warn("No notes to export");if("undefined"==typeof MidiWriter)return console.error("MidiWriter library not loaded"),void alert("MIDI export not available. Please refresh the page.");const i=new MidiWriter.Track;i.setTempo(r),i.setTimeSignature(4,4);const o=[...e].sort((e,t)=>e.startTime-t.startTime),a=new Map;o.forEach(e=>{const t=e.startTime;a.has(t)||a.set(t,[]),a.get(t).push(e)});let n=0;[...a.keys()].sort((e,t)=>e-t).forEach(e=>{const t=a.get(e),r=this.ticksPerBeat/4,o=e*r,d=o-n,s=t.map(e=>e.pitch),c=t[0].duration*r,l=`T${c}`,m=new MidiWriter.NoteEvent({pitch:s,duration:l,velocity:100,wait:`T${d}`});i.addEvent(m),n=o+c});const d=new MidiWriter.Writer(i);this.download(d.dataUri(),`${t}.mid`)}download(e,t){const r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}generateFilename(e){if(!e||0===e.trim().length)return"text2midiart";return`text2midiart-${e.trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}`}}