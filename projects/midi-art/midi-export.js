class MidiExport{constructor(){this.ticksPerBeat=128}"export"(t,e="text2midiart",r=120){if(!t||0===t.length)return void console.warn("No notes to export");if("undefined"==typeof MidiWriter)return console.error("MidiWriter library not loaded"),void alert("MIDI export not available. Please refresh the page.");const i=new MidiWriter.Track;i.setTempo(r),i.setTimeSignature(4,4);const o=[...t].sort((t,e)=>t.startTime-e.startTime),a=new Map;o.forEach(t=>{const e=t.startTime;a.has(e)||a.set(e,[]),a.get(e).push(t)});let n=0;const d=[...a.keys()].sort((t,e)=>t-e),s=this.ticksPerBeat/4;d.forEach(t=>{const e=a.get(t),r=Math.round(t*s),o=Math.max(0,r-n),d=e.map(t=>t.pitch),c=e[0].duration,l=Math.max(1,Math.round(c*s)),h=new MidiWriter.NoteEvent({pitch:d,duration:`T${l}`,velocity:100,wait:`T${o}`});i.addEvent(h),n=r});const c=new MidiWriter.Writer(i);this.download(c.dataUri(),`${e}.mid`)}download(t,e){const r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}generateFilename(t){if(!t||0===t.trim().length)return"midi-art-gen";return`midi-art-gen-${t.trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}`}}